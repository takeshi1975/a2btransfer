DROP TABLE A2BT_LOCATION;
DROP TABLE A2BT_ROUTE;

SELECT * FROM ALL_TABLES WHERE TABLE_NAME LIKE 'A2B%';

CREATE TABLE A2BT_LOCATION(
   LOCATION_CODE VARCHAR2(3) NOT NULL PRIMARY KEY,
   LOCATION_NAME VARCHAR2(100) NOT NULL,
   LOCATION_TYPE VARCHAR2(100) NOT NULL,
   COUNTRY_CODE VARCHAR(3) NOT NULL,
   COUNTRY VARCHAR(50) NOT NULL,
   LATITUDE FLOAT NOT NULL,
   LONGITUDE FLOAT NOT NULL           
);

CREATE TABLE A2BT_ROUTE(
    ROUTE_ID INTEGER NOT NULL PRIMARY KEY,
    ROUTE_CODE_FROM VARCHAR(3) NOT NULL REFERENCES A2BT_LOCATION(LOCATION_CODE)
    	ON DELETE CASCADE,
    ROUTE_CODE_TO VARCHAR(3) NOT NULL REFERENCES A2BT_LOCATION(LOCATION_CODE)
    	ON DELETE CASCADE    
);

CREATE OR REPLACE VIEW  A2B_TRANSFER_COMISSION AS
  SELECT T2.ID, T2.CODIGO, MARGEN, COMI, FECHA_INICIO, FECHA_FIN 
  FROM POLITICA_COMERCIAL_MEDIDA T1 
    LEFT JOIN TIPO_SERVICIO T2 
      ON (T1.TIPO_SERVICIO_ID=T2.ID) 
    LEFT JOIN INTEGRACION T3 
      ON (T1.INTEGRACION_ID=T3.ID) 
         WHERE (T3.CODIGO='A2B' AND T2.CODIGO='TRAS');     
